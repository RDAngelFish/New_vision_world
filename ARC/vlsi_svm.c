#include "embARC.h"
#include "embARC_debug.h"
#include "stdlib.h"
#include "embARC_error.h"
#include "board.h"

#include "vlsi_svm.h"

//parameters depend on SVM
const float support_vector[SVM_KERNEL_SIZE][SVM_INPUT_SIZE] = {
{-1.9,-0.1,-1.3, 0.5,-0.7, 1.2,-0.2, 0.6,-2.6,-0.2,-0.8, 1.6,-0.3, 1.0,-0.1, 0.9,-1.6, 0.0,-0.6, 1.1,-0.6, 1.3,-0.2, 0.8,-0.8, 0.4,-0.3, 1.1,-0.7, 1.2,-0.6, 0.9, 0.0, 1.1,-0.4, 1.0,-0.4, 0.8,-0.5, 0.6, 1.9, 0.1, 1.3, 0.6, 1.4, 1.1, 0.7, 1.0, 3.0, 0.4, 0.9, 1.0, 0.7, 0.8, 0.5, 1.0, 2.2, 0.8, 0.9, 1.4, 0.7, 1.2, 0.5, 0.7, 1.4, 1.2, 0.6, 1.5, 0.9, 1.2, 0.6, 0.7, 0.9, 1.6,-0.2, 1.1, 0.2, 0.6, 0.2, 0.7},
{-1.1, 0.3,-1.3, 0.2,-0.7, 1.1,-0.2, 0.7,-1.9,-0.3,-0.7, 1.7,-0.4, 1.0,-0.1, 0.9,-0.9,-0.2,-0.6, 1.3,-0.6, 1.2,-0.2, 0.7, 0.0, 0.3,-0.5, 1.2,-0.6, 1.0,-0.4, 0.7, 0.6, 1.0,-0.3, 1.1,-0.3, 0.6,-0.5, 0.7, 2.5, 0.6, 1.7, 0.1, 1.2, 0.8, 0.5, 0.9, 3.7, 0.1, 0.8, 1.0, 0.8, 0.8, 0.5, 0.9, 2.8, 0.4, 1.1, 1.5, 0.8, 1.3, 0.5, 0.8, 2.0, 0.8, 0.8, 1.6, 0.9, 1.1, 0.5, 0.8, 1.4, 1.4, 0.3, 1.1, 0.3, 0.7, 0.3, 0.8},
{-1.2, 0.9,-1.3,-0.1,-0.3, 0.7,-0.3, 1.0,-1.7,-0.2,-0.3, 0.9,-0.1, 0.9,-0.2, 0.9,-0.7, 0.0,-0.3, 1.4,-0.4, 1.2,-0.4, 0.9, 0.1, 0.4,-0.1, 1.4,-0.5, 1.2,-0.5, 0.6, 0.7, 1.0, 0.1, 1.1,-0.3, 0.6,-0.4, 0.4, 2.0, 0.3, 1.7, 0.6, 1.2, 1.3, 0.3, 0.5, 3.3, 0.7, 1.2, 1.5, 0.5, 1.1, 0.3, 0.8, 2.4, 0.8, 0.9, 0.9, 0.7, 1.2, 0.5, 0.9, 1.7, 1.2, 0.5, 1.0, 0.7, 1.1, 0.5, 0.8, 1.1, 1.6,-0.3, 1.2, 0.0, 0.6, 0.3, 0.7},
{-0.3, 0.3,-2.3,-0.2,-0.5, 1.2,-0.7, 0.5,-2.1,-0.7,-0.7, 1.3,-0.4, 1.1, 0.0, 0.9,-1.2,-0.5,-0.6, 1.0,-0.5, 1.3,-0.3, 0.9,-0.3,-0.4,-0.2, 1.2,-0.6, 1.1,-0.3, 1.1, 0.5,-0.2, 0.1, 1.1,-0.3, 0.7,-0.3, 0.8, 1.2, 0.1, 1.7, 0.4, 0.9, 1.2, 0.9, 0.8, 2.6,-0.1, 1.2, 1.5, 0.5, 0.7, 0.6, 0.5, 1.7, 0.0, 0.9, 0.7, 0.7, 1.1, 0.3, 0.8, 0.9, 0.5, 0.6, 0.7, 0.7, 1.0, 0.6, 0.9, 0.0, 0.9, 0.3, 0.9, 0.1, 0.6, 0.2, 0.7},
{-1.2, 0.3,-1.1, 0.3,-0.6, 1.0,-0.5, 1.0,-1.7,-0.2,-0.5, 1.5,-0.2, 1.1,-0.3, 0.8,-0.7, 0.0,-0.5, 1.5,-0.4, 1.2,-0.4, 0.9, 0.1, 0.5,-0.2, 1.3,-0.6, 1.1,-0.4, 0.6, 0.8, 1.0, 0.0, 1.1,-0.3, 0.6,-0.4, 0.5, 3.4, 0.7, 1.7, 0.8, 0.8, 1.0, 0.5, 0.9, 4.3, 0.8, 1.1, 1.6, 0.5, 1.1, 0.2, 0.7, 3.3, 0.9, 1.0, 1.4, 0.7, 1.2, 0.4, 0.8, 2.6, 1.3, 0.6, 1.2, 0.7, 1.2, 0.6, 0.7, 1.8, 1.6,-0.2, 1.1, 0.4, 0.6, 0.4, 0.6},
{-0.4, 0.2,-2.3,-0.1,-0.5, 1.1,-0.7, 0.6,-2.2,-0.7,-0.8, 1.3,-0.3, 1.0,-0.1, 0.8,-1.2,-0.6,-0.8, 1.1,-0.4, 1.3,-0.2, 0.8,-0.4,-0.4,-0.4, 1.1,-0.5, 1.2,-0.5, 0.9, 0.5,-0.1,-0.1, 0.9,-0.2, 0.6,-0.3, 0.6, 1.0, 0.2, 1.5, 0.2, 0.8, 0.8, 1.1, 0.7, 2.1,-0.4, 1.1, 0.8, 0.7, 0.9, 0.6, 0.9, 1.1,-0.3, 1.3, 1.6, 0.6, 1.2, 0.4, 0.8, 0.4, 0.1, 0.9, 1.5, 0.7, 1.1, 0.5, 0.8,-0.4, 0.4, 0.0, 0.8, 0.0, 0.5, 0.0, 0.5},
{-0.7, 0.3,-0.3, 0.2, 0.1, 0.2, 0.4, 0.3, 0.2,-0.7, 0.6, 1.2, 0.2, 1.1, 0.2, 0.9, 1.1,-0.7, 0.9, 0.6, 0.2, 1.2, 0.1, 0.9, 1.8,-0.5, 1.1, 0.4, 0.2, 1.1, 0.0, 0.8, 2.4,-0.3, 1.0, 0.5, 0.4, 0.7, 0.2, 0.7, 0.4, 0.5, 0.7, 0.6, 0.2, 0.7, 0.1, 0.8,-0.4,-0.1,-0.1, 1.2, 0.1, 1.0, 0.0, 1.0,-1.3,-0.2,-0.8, 0.1,-0.2, 1.0, 0.1, 1.0,-2.2,-0.1,-0.7, 0.3,-0.2, 1.0, 0.2, 0.9,-2.5, 0.1,-1.1, 0.8,-0.4, 0.6, 0.0, 0.5},
{-0.8, 0.5,-0.5, 0.4, 0.0, 0.3, 0.2, 0.2,-0.5,-0.4, 0.5, 0.8, 0.2, 0.8, 0.2, 0.7, 0.6,-0.4, 0.6, 1.1, 0.1, 1.1, 0.1, 0.9, 1.4,-0.2, 0.7, 1.1, 0.2, 1.2,-0.1, 0.8, 2.2, 0.3, 0.7, 0.6, 0.2, 0.6, 0.3, 0.5, 0.5, 0.5, 0.7, 0.5, 0.2, 0.5,-0.1, 0.9,-0.3,-0.3,-0.3, 0.9, 0.0, 0.8, 0.0, 0.7,-1.3,-0.4,-0.3, 1.3, 0.3, 1.3, 0.4, 1.0,-2.1,-0.1,-0.5, 1.0, 0.2, 1.1, 0.2, 0.9,-2.8, 0.3,-0.8, 0.2,-0.4, 0.5,-0.4, 0.6},
{ 0.7, 1.3, 0.3, 1.3,-0.1, 0.7,-0.4, 0.7, 1.6, 1.8, 0.1, 0.6, 0.1, 0.9, 0.0, 0.9, 2.6, 1.7, 0.1, 1.3, 0.0, 1.4,-0.4, 0.8, 3.5, 2.0, 0.3, 1.2,-0.1, 1.1,-0.2, 0.9, 4.2, 2.4, 0.7, 0.7, 0.2, 0.4, 0.1, 0.6, 0.6,-1.0, 2.9,-3.5,-0.2, 0.4,-0.8, 0.8, 3.2,-2.4,-0.3,-1.2, 0.1,-0.2,-0.5, 0.6, 2.0,-1.0, 0.5,-0.9,-0.5, 0.1, 3.2,-0.7, 2.5,-2.9,-0.5, 1.4, 0.7,-0.9, 2.5,-0.1, 2.6,-3.0, 0.9,-1.3,-0.3, 0.3,-0.7, 0.7},
{-0.4, 0.4,-1.9, 0.0,-0.8, 1.0,-0.5, 0.7,-2.0,-0.5,-0.7, 1.6,-0.2, 1.1, 0.0, 0.9,-1.1,-0.4,-0.5, 0.9,-0.4, 1.0,-0.2, 0.9,-0.3,-0.2, 0.0, 1.0,-0.3, 0.9,-0.3, 1.0, 0.4,-0.1, 0.3, 0.7, 0.2, 0.6, 0.0, 0.8, 0.9, 0.8, 2.3, 1.2,-0.2,-0.2, 0.5, 0.9, 2.1, 0.1, 1.2, 1.4, 0.4, 1.1, 0.2, 0.8, 1.1, 0.2, 0.9, 0.6, 0.6, 1.0, 0.4, 0.8, 0.3, 0.4, 0.6, 0.8, 0.6, 0.9, 0.4, 1.0,-0.4, 0.7,-0.1, 0.7, 0.0, 0.6,-0.2, 0.6},
{-0.7,-0.3,-0.8, 0.2,-0.5, 1.0,-0.4, 0.8,-0.8, 1.2, 0.1, 0.1,-1.3, 1.2,-0.1,-0.5,-0.6, 1.7,-0.3, 0.7,-0.8, 0.0,-0.2,-0.4,-0.4, 1.9,-0.5, 0.5,-0.7, 0.0,-0.2,-0.5,-0.3, 2.1,-0.9, 0.1,-0.8, 0.4, 0.2,-0.6, 0.7,-0.4, 0.7, 0.3, 0.4, 1.1, 0.1, 0.8, 0.4, 1.4, 0.2, 0.2, 0.7, 0.3, 0.7, 0.0, 0.2, 1.9, 0.7, 0.5, 0.9, 0.0, 0.7,-0.1, 0.3, 2.2, 0.6, 0.5, 0.9,-0.1, 0.5,-0.2, 0.3, 2.4, 0.5, 0.4, 0.6,-0.2, 0.0, 1.4},
{-3.6,-0.1,-0.4,-0.6, 0.5,-1.7,-0.6,-0.8,-4.1,-0.9, 0.2, 0.0,-0.3,-1.2, 0.1,-1.0,-3.5,-0.9, 0.2, 0.0, 0.0,-1.1, 0.6,-0.9,-2.8,-2.1, 0.3, 1.2,-0.2,-1.4, 0.3,-0.5,-2.5,-2.2, 0.8, 0.9,-0.4,-0.4,-0.3,-1.0, 2.2, 2.0, 2.6, 0.0, 0.8, 1.8, 0.3, 0.3, 4.3, 1.9, 0.8, 0.3, 0.7, 1.4, 0.3, 0.8, 3.7, 2.1, 0.5, 1.7, 1.0, 0.6, 0.6, 0.2, 3.1, 2.3, 0.5, 0.7, 1.1, 1.6, 1.0,-0.1, 2.8, 2.3, 0.0, 0.3, 1.4, 1.9, 0.2, 0.1},
{ 0.0,-0.7,-0.1,-1.0,-0.6,-0.2,-1.1,-0.7,-1.5, 0.0,-0.5,-0.3, 0.0,-1.2, 0.2,-1.0,-1.3, 0.0, 0.1,-0.1, 0.2,-1.6, 0.8,-0.3,-1.3, 0.1, 0.0, 0.1, 0.7,-1.9, 0.7,-0.2,-0.1,-1.5, 0.5, 0.8,-0.2,-0.1,-0.2,-1.1, 1.0, 0.2,-0.6,-2.5, 1.6,-0.6, 0.7,-0.1, 2.2,-1.5, 1.1, 0.2,-0.1, 0.1,-0.4,-1.7, 2.4,-1.3,-0.3,-1.4,-0.3, 0.0, 1.8, 1.5, 1.9,-1.2,-0.9,-1.5, 0.9, 0.1, 1.0, 2.5, 1.8,-1.2,-1.7,-1.9, 2.7, 3.1, 0.0, 0.0},
{-1.0, 0.0,-0.3, 0.1, 0.0, 1.3, 0.1, 1.0, 0.2, 1.5,-1.5, 0.9,-0.2, 0.3, 0.2,-0.5, 0.2, 1.9,-0.5, 0.8,-0.7,-0.1,-0.5,-0.6,-0.7, 1.7, 0.5, 1.0,-0.7,-0.1,-0.1,-0.5, 0.3, 2.2,-0.5, 0.5, 0.0,-0.2,-0.1,-0.4, 4.7,-2.6,-0.1,-1.6,-0.3,-0.5, 0.3,-0.9, 4.8,-4.1, 0.0, 0.2,-1.4,-0.6,-0.5, 0.4, 4.6,-4.1,-0.3, 0.5,-0.5,-0.5,-0.7, 0.0, 3.2,-3.4, 0.7,-0.1,-0.1,-0.5,-0.7, 0.2, 2.5,-3.1, 2.2, 0.5,-2.1,-0.7, 0.0,-0.6},
{-0.3, 2.1,-1.6, 2.3,-0.7,-3.1, 0.0,-0.7,-2.0, 2.7,-1.5,-0.3,-0.1,-0.9, 0.1,-1.1,-2.0, 2.5,-0.6,-0.1,-0.2,-1.2,-0.4,-1.1,-1.7, 2.7, 0.0,-0.5,-0.4,-1.2,-0.2,-0.9,-1.2, 2.7, 0.2,-1.7,-0.3,-0.1,-0.5,-0.5, 2.5, 1.5, 2.5, 0.2, 0.3, 1.6, 0.2, 0.4, 4.2, 1.5, 0.6, 0.3, 0.7, 1.3, 0.5, 0.8, 3.3, 1.7, 0.8, 1.2, 0.3, 0.6, 1.4, 0.7, 2.7, 2.2, 0.8, 0.2, 0.7, 1.0, 1.6, 0.7, 2.5, 1.7, 0.1, 0.3, 0.9, 0.6, 2.3, 1.5},
{-0.4,-0.3,-0.8, 0.0,-0.3, 0.4,-0.4, 1.2,-0.9,-0.3,-0.8, 1.7, 0.0, 0.4,-0.1, 0.8,-0.7, 1.2, 0.5, 0.7,-0.7, 0.7,-0.8, 0.3,-0.9, 1.0, 0.8, 0.9,-1.0, 0.4,-0.6, 0.4,-1.4, 1.0, 1.5, 1.0,-2.0, 0.1, 0.1, 0.5, 1.0, 1.1, 1.5,-0.3, 0.1, 0.1, 0.5,-0.1, 2.6, 0.9, 1.5, 2.0, 0.0,-0.1, 0.2, 0.7, 3.2, 2.4, 0.5, 0.6, 0.2, 0.0, 0.3, 0.6, 3.7, 3.3,-0.8, 0.0, 0.8, 0.2, 0.6, 0.1, 4.0, 3.1,-1.4, 0.4, 1.0, 0.2, 0.7,-0.1},
{-0.7,-0.2,-0.4, 0.2,-0.6, 1.2, 0.0, 0.7,-0.1, 0.8,-1.4, 0.8,-0.1, 0.7, 0.1, 0.2, 0.0, 0.8,-0.5, 1.2,-0.4, 0.6,-0.3,-0.1, 0.3, 1.4,-0.5, 0.9,-0.3, 0.2,-0.3,-0.2, 0.4, 1.8,-0.3, 0.5,-0.3, 0.2,-0.2,-0.2, 0.6, 0.4, 0.0, 0.6, 2.7,-1.7, 0.7,-1.6, 4.9, 0.0,-0.5, 0.0, 0.0,-0.9, 0.2,-0.7, 1.4,-0.4, 2.2, 0.2,-0.1,-0.8, 0.6,-1.3, 1.7,-1.4, 0.6, 0.7, 0.6,-0.6, 0.2,-0.9, 1.7,-1.4,-0.2,-0.1, 0.5,-0.1, 0.3,-0.2},
{-0.3,-0.9,-0.8,-0.8,-0.6,-0.3,-0.1,-0.1,-0.1,-1.5,-1.6, 0.1,-0.4, 0.0, 0.3, 0.1,-0.1,-0.5,-1.9,-0.1, 0.2, 0.0, 0.5,-0.2,-0.3, 0.3,-1.8,-0.2, 0.4,-0.1, 0.5,-0.2,-0.4, 0.7,-1.4, 0.0, 0.4, 0.0, 0.3,-0.1, 0.2,-0.8, 0.8,-1.1, 0.5,-0.2, 0.5,-0.8, 0.3,-1.6, 0.6,-0.1, 0.8,-0.2, 0.6, 0.0, 0.6,-0.8, 0.6,-0.1, 0.9,-0.2, 0.5,-0.1, 0.7,-0.2, 0.7, 0.0, 0.8,-0.3, 0.6,-0.2, 0.9, 0.4, 0.8, 0.0, 0.6,-0.2, 0.4,-0.3},
{-0.9,-0.1,-0.4, 0.0,-0.1, 1.1,-0.5, 1.1,-1.3, 0.0, 0.6, 2.5,-1.1,-0.2,-0.3,-0.2,-0.1, 2.3,-0.6, 0.2,-0.9,-0.4,-0.1,-0.5,-1.2, 1.4, 0.6, 1.0,-0.8,-0.3,-0.2,-0.5,-1.3, 1.3, 0.7, 0.9,-0.1,-0.3,-0.2,-0.2, 0.3,-1.0, 0.5,-1.1, 0.5,-0.3, 0.6,-0.6, 0.2,-1.6, 1.0,-0.4, 0.7,-0.1, 0.2, 0.1, 0.4,-0.7, 1.4,-0.5, 0.5,-0.1, 0.1,-0.2, 0.6, 0.0, 1.3,-0.5, 0.5,-0.1, 0.0,-0.2, 1.0, 0.5, 0.8,-0.2, 0.5,-0.3, 0.1,-0.2},
{-0.8,-0.2,-0.7, 0.3,-0.2, 1.2, 0.2, 1.1,-0.2, 1.5,-0.6, 1.1,-0.9, 0.1,-0.1,-0.2, 0.1, 2.0,-1.0, 0.9,-0.7,-0.2, 0.0,-0.2, 0.1, 2.3,-1.0, 0.7,-0.4,-0.2, 0.0,-0.4,-0.1, 2.5,-0.7, 0.4,-0.2,-0.2,-0.1,-0.3, 1.1, 0.0, 1.5,-3.7, 0.6,-0.2, 0.6,-0.6, 3.7,-3.7,-1.4, 0.2, 1.0, 0.0, 0.8, 0.0, 2.1,-2.6, 0.3,-0.1, 1.2,-0.2, 0.8, 0.0, 2.4,-2.2, 0.4, 0.2, 1.0,-0.3, 0.7,-0.3, 2.6,-1.8, 0.7, 0.1, 0.4, 0.0, 0.7,-0.3},
{-1.4,-1.0,-1.5,-0.7,-0.3, 0.1,-0.4, 0.5,-1.9,-1.1,-1.3, 0.6,-0.6,-0.3, 0.3,-0.2,-1.6,-0.3,-1.8, 0.4,-0.4,-0.2, 0.3,-0.3,-1.6, 0.4,-1.7, 0.3,-0.4,-0.3, 0.2,-0.2,-1.6, 1.0,-1.3, 0.2,-0.6,-0.1,-0.3,-0.2,-2.6,-1.2, 0.9, 0.0, 0.9, 0.6, 0.1,-1.2, 0.3, 0.0, 0.1, 0.1, 0.1,-0.9,-0.2,-0.9,-0.3, 0.5, 0.1,-0.3, 0.1,-1.2, 0.2,-1.1,-0.1,-0.8, 0.0, 0.9, 0.1,-1.6, 0.1,-0.6,-1.3,-1.1,-0.8, 0.0, 0.9,-0.3, 0.1,-0.2},
{-0.5, 0.1,-0.2, 0.1,-0.1, 1.1, 0.1, 0.2,-0.8,-0.1, 0.1, 2.1,-0.3, 0.5, 0.1,-0.5, 0.2, 0.4, 0.1, 1.9,-0.6, 0.3,-0.2,-0.7, 0.8, 1.5,-0.4, 0.8,-0.4, 0.0,-0.2,-0.3, 0.8, 1.5,-0.3, 0.6,-0.2, 0.1,-0.1,-0.2, 0.7,-0.2, 0.9, 0.4, 0.3, 1.1, 0.1, 0.9, 0.5, 1.7, 0.5, 0.5, 0.7, 0.6, 0.2,-0.5, 0.4, 2.2, 0.7, 0.7, 0.6,-0.1, 0.0,-0.3, 0.3, 2.6, 0.8, 0.4, 0.6,-0.1, 0.0,-0.3, 0.5, 2.7, 0.8, 0.3, 0.1,-0.1, 0.1,-0.4},
{-1.0,-0.9, 0.0,-0.7,-0.4,-0.1, 0.0,-0.6,-1.7,-0.3, 0.2,-1.4,-0.1,-0.4, 0.3,-0.3,-1.7,-0.2, 0.6,-1.1, 0.6,-0.5, 0.8, 0.0,-1.5, 0.0, 0.6,-1.3, 0.6,-0.5, 0.6, 0.0,-1.4, 0.0, 0.5,-1.6, 0.6,-0.2, 0.7, 0.2, 1.4,-1.4, 2.2,-2.5,-0.4,-0.8, 0.5,-0.8, 2.0,-4.0, 0.2,-0.5, 1.1,-0.1, 0.7, 0.1, 1.7,-3.1, 0.7,-0.3, 1.2,-0.3, 0.7,-0.2, 1.8,-2.5, 0.9,-0.3, 1.0,-0.3, 0.8,-0.3, 2.2,-2.1, 1.0,-0.1, 0.6,-0.3, 0.7,-0.3},
{-0.8, 5.4,-1.3,-2.3, 0.3, 3.0,-2.6,-1.9,-4.2, 4.1, 0.2, 0.1, 0.2,-0.6,-0.6, 0.2,-3.0, 4.4,-0.2,-0.3,-0.6,-1.3, 0.0,-0.8,-2.2, 4.0,-0.7,-0.4, 0.0,-1.1,-0.8,-0.7,-2.3, 3.2, 0.1,-0.8,-0.3,-0.2, 0.0,-0.3, 2.7, 2.2, 1.5,-0.2, 0.1,-0.2, 0.7, 1.9, 3.2, 1.8, 1.1, 0.1, 0.6, 1.6, 0.2, 0.7, 2.9, 1.8, 0.6, 1.6, 0.8, 0.8, 0.7, 0.3, 2.6, 1.8, 0.6, 1.4, 0.3, 1.2, 1.5, 0.0, 2.3, 1.8, 0.3, 0.5, 0.6, 2.1, 0.3, 0.4},
{-0.3,-1.0,-0.6,-1.0,-0.6,-0.2,-0.3,-0.4, 0.0,-1.9,-1.4, 0.0,-0.5, 0.1,-0.1, 0.0, 0.0,-1.0,-1.7,-0.1,-0.2, 0.1, 0.4,-0.2,-0.2,-0.3,-1.6, 0.0, 0.0,-0.2, 0.4,-0.1,-0.4, 0.4,-1.4,-0.1, 0.2,-0.1, 0.3, 0.0, 1.8,-3.1, 1.8,-1.5, 0.0,-0.5,-0.1,-0.6, 4.1,-4.2,-0.5,-0.3,-0.9,-0.1,-0.7, 0.3, 4.2,-3.9,-0.6,-0.2,-0.3, 0.0, 0.6, 0.1, 4.3,-3.2,-0.7,-0.6,-0.3, 0.2,-0.5, 0.3, 4.4,-3.0,-0.8, 0.5,-0.2, 0.0,-0.4,-0.1},
{-0.9,-0.1,-0.8, 0.6,-0.1, 1.1, 0.0, 1.0,-0.3, 1.7,-0.8, 1.2,-0.7,-0.1, 0.0,-0.4, 0.1, 2.2,-1.2, 0.9,-0.5,-0.3, 0.1,-0.5, 0.1, 2.5,-1.2, 0.6,-0.2,-0.3, 0.1,-0.5,-0.1, 2.6,-0.7, 0.3,-0.2,-0.2, 0.0,-0.3, 0.2,-1.0, 0.4,-1.1, 0.4,-0.3, 0.5,-0.7, 0.0,-1.6, 0.4,-0.2, 0.9,-0.2, 0.5, 0.0, 0.2,-0.7, 0.7,-0.3, 0.8,-0.3, 0.5,-0.2, 0.3,-0.1, 0.8,-0.2, 0.7,-0.3, 0.5,-0.3, 0.7, 0.5, 0.8,-0.2, 0.4,-0.4, 0.4,-0.2},
{ 1.6,-3.1,-1.2,-0.2,-0.3, 1.6,-0.2, 0.0, 0.7,-3.5,-0.8, 1.9, 0.0, 0.1, 0.0, 0.8, 1.9,-3.1,-0.8, 1.5,-0.2, 0.9,-0.7, 0.3, 2.2,-2.4,-0.5, 0.8,-0.3, 0.1,-0.2, 0.8, 2.1,-2.0, 0.0, 0.1,-0.3, 0.4,-0.6, 0.8, 1.4,-0.3, 1.2,-2.4, 1.5,-0.9, 0.9,-0.7, 5.0,-2.1, 0.0,-0.1,-0.2,-0.6, 0.4,-0.1, 4.4,-1.6,-0.2,-0.5, 0.1,-0.7, 1.0, 0.0, 2.7,-2.1, 1.5, 0.5,-0.2,-1.0,-0.8,-0.4, 2.6,-2.2, 2.0, 0.9,-1.6,-0.6, 0.0,-0.9},
{ 0.0, 0.0, 0.2,-0.4,-1.0, 2.0, 0.0, 0.7, 0.5,-0.5,-1.3, 2.0,-0.1, 0.4, 0.1, 0.6, 0.4,-0.2, 0.2, 2.0,-0.6, 0.6,-0.5, 0.2, 0.4,-0.1, 0.3, 1.9,-0.5, 0.5,-0.7, 0.2,-0.1, 0.4, 0.9, 0.8,-0.2, 0.9,-1.3, 0.4, 1.8, 1.5, 0.7, 0.3, 1.0, 0.9, 0.1,-0.1, 3.6, 3.3, 0.5, 0.2, 0.6,-0.6, 0.3, 0.7, 4.0, 3.4,-0.1, 0.4, 0.7,-1.0, 0.5, 0.7, 4.4, 3.3,-0.7, 0.5,-0.2,-0.8, 1.6, 0.6, 4.5, 3.2,-1.2,-0.6,-0.2, 0.4, 0.7, 1.3},
{-1.0,-0.4,-1.5, 0.4,-0.9, 1.0,-1.0, 0.6,-2.3, 0.8,-1.1, 1.9, 0.0,-0.6, 0.2,-0.5,-1.6, 1.4,-1.0, 1.3, 0.0,-0.5, 0.4,-0.5,-1.1, 1.8,-0.8, 1.0, 0.1,-0.5, 0.2,-0.4,-0.7, 2.2,-0.3, 0.4,-0.1,-0.2, 0.1,-0.4,-0.6,-1.2,-0.5,-1.4,-0.7,-1.1,-0.4,-0.9,-0.6,-3.0, 0.9,-1.5, 0.7,-0.6, 0.7,-0.5, 0.1,-2.7, 1.1,-1.2, 0.6,-0.1, 0.0,-0.2, 0.8,-2.2, 1.0,-1.2, 0.5,-0.4, 0.3,-0.2, 1.4,-1.7, 0.6,-0.9, 0.5,-0.5, 0.3,-0.5},
{ 0.5,-0.3,-2.5, 1.6,-0.4,-1.5,-1.2,-0.4,-1.1,-0.6,-1.2, 0.5,-0.3,-0.2,-0.1,-0.2,-0.6, 0.3, 0.1,-0.2,-1.2, 0.6,-1.0, 0.9, 0.0, 0.4,-0.3, 1.1, 0.2,-0.1,-2.6, 0.2, 0.3, 1.3,-0.4, 0.5, 0.3, 0.0, 0.0, 0.0,-0.6,-1.1,-0.5,-1.4,-0.6,-1.0,-0.3,-0.9,-0.4,-2.8, 0.9,-1.4, 0.7,-0.5, 0.6,-0.3, 0.2,-2.5, 0.8,-1.6, 0.6,-0.6, 0.6,-0.5, 1.0,-2.1, 0.8,-1.5, 0.6,-0.7, 0.5,-0.5, 1.5,-1.6, 0.9,-1.0, 0.5,-0.4, 0.3,-0.6},
{-1.3, 0.2,-1.6, 0.9,-0.6, 1.4,-0.5, 0.8,-2.8, 1.1,-0.7, 1.4,-0.4, 0.8,-0.1, 0.9,-1.9, 1.4,-0.9, 1.6, 0.2,-0.1, 0.3,-0.3,-1.2, 1.9,-0.9, 1.4, 0.3,-0.3, 0.2,-0.3,-0.6, 2.4,-0.8, 0.9, 0.2,-0.1, 0.0,-0.2,-0.7,-1.3,-0.4,-1.4,-0.7,-1.1,-0.4,-0.9,-0.6,-2.9, 1.2,-1.3, 0.7,-0.2, 0.5,-0.1, 0.0,-2.6, 1.2,-1.4, 0.8,-0.3, 0.8,-0.5, 0.7,-2.1, 1.1,-1.3, 0.5,-0.7, 0.5,-0.6, 1.4,-1.7, 0.8,-0.8, 0.4,-0.5, 0.3,-0.4},
{-0.3,-1.2,-0.3,-0.9,-0.9,-1.2,-0.3,-0.2,-1.2,-1.8,-0.3,-1.1,-0.3,-1.0,-0.2,-0.8,-2.0,-1.3, 0.1,-1.4,-0.3,-1.4,-0.2,-0.7,-2.6,-0.9,-0.2,-1.5, 0.3,-0.9, 0.0,-1.4,-3.0,-0.8,-0.1,-1.3, 0.3,-0.6, 0.4,-0.9,-0.7,-1.1,-0.6,-1.4,-0.9,-0.8,-0.5,-0.7,-1.0,-2.9, 0.3,-1.6, 0.5,-0.8, 0.5,-0.7,-0.3,-2.6, 0.9,-1.5, 0.8,-0.2, 0.2, 0.1, 0.4,-2.1, 1.0,-1.4, 0.4,-0.3, 0.3, 0.0, 1.1,-1.7, 0.6,-1.0, 0.5,-0.5, 0.3,-0.4},
{ 1.1,-1.2,-0.6,-0.3,-0.7,-0.1, 0.1, 0.0,-0.2, 0.5,-0.3,-0.5,-0.2,-1.7,-1.1,-0.6, 0.4, 0.2,-0.6,-0.1,-0.5,-1.6,-0.9,-0.8, 0.5, 0.2,-0.6,-0.2,-0.8,-1.5,-0.7,-0.6, 0.5,-1.2,-0.9,-0.9,-0.5, 0.3,-1.0,-0.2,-0.6,-1.1,-0.5,-1.4,-0.6,-1.0,-0.5,-1.0,-0.6,-2.8, 1.1,-1.3, 0.3,-0.3, 0.3,-0.1, 0.0,-2.4, 0.8,-1.6, 0.6,-0.4, 0.3,-0.1, 0.7,-2.0, 0.7,-1.4, 0.6,-0.5, 0.2, 0.0, 1.3,-1.6, 0.7,-0.9, 0.4,-0.4, 0.3,-0.4},
{-0.7,-0.4,-1.3, 0.2,-1.0, 0.5,-0.8, 0.1,-2.2, 0.4,-1.4, 1.2, 0.3, 0.0, 0.4,-0.2,-1.7, 1.1,-1.2, 1.1, 0.3,-0.1, 0.3,-0.3,-1.3, 1.7,-1.1, 0.8, 0.3,-0.1, 0.3,-0.4,-1.0, 2.1,-0.6, 0.5, 0.2,-0.2, 0.2,-0.3,-0.6,-1.2,-0.5,-1.3,-0.8,-1.1,-0.5,-0.8,-0.5,-2.9, 1.0,-1.2, 0.6,-0.1, 0.3, 0.2, 0.2,-2.5, 1.0,-1.4, 0.7,-0.2, 0.8,-0.6, 0.9,-2.1, 1.0,-1.4, 0.6,-0.6, 0.3,-0.4, 1.5,-1.7, 0.7,-0.9, 0.4,-0.5, 0.3,-0.5},
{-0.2,-1.1,-1.0,-1.2,-0.5,-0.6,-0.6,-0.9,-2.3,-0.4, 0.2,-1.6, 0.4,-0.9, 0.0, 0.0,-1.8,-1.0, 0.2,-0.9,-0.1,-0.8,-0.1,-0.4,-2.3,-0.4, 0.7,-1.7, 0.1,-0.4,-0.4,-0.7,-2.4,-0.3, 0.3,-2.1, 0.2,-0.9,-0.2,-0.2,-0.7,-1.2,-0.5,-1.5,-0.6,-1.1,-0.3,-0.9,-0.8,-2.9, 1.1,-1.4, 0.7,-0.5, 0.7,-0.3,-0.2,-2.7, 0.9,-1.5, 0.9,-0.6, 0.6,-0.3, 0.5,-2.3, 0.8,-1.4, 0.5,-0.8, 0.6,-0.5, 1.0,-1.9, 0.8,-0.7, 0.3,-0.5, 0.3,-0.5},
{-1.0, 0.1,-1.6, 2.0,-0.1,-0.1,-0.3, 0.0,-2.8, 0.7, 2.1,-0.9,-1.5, 1.0, 0.3, 0.5,-0.3, 0.3,-0.4, 0.7, 0.1, 0.2, 0.1, 0.0, 0.4, 0.0,-1.0, 1.1, 1.2, 0.2,-0.2, 0.8, 0.2, 1.7, 0.5,-0.2, 0.0, 0.2, 0.2, 0.3,-0.6,-1.2,-0.6,-1.3,-0.7,-1.1,-0.6,-0.8,-0.6,-2.9, 1.0,-1.4, 0.7,-0.3, 0.6, 0.0, 0.0,-2.5, 0.8,-1.6, 0.7,-0.5, 0.5, 0.0, 0.8,-2.0, 0.7,-1.4, 0.6,-0.7, 0.4,-0.2, 1.4,-1.5, 0.8,-0.9, 0.4,-0.6, 0.5,-0.5},
{-0.7, 0.8,-1.4,-0.9, 0.0,-1.7,-1.2,-0.4,-0.5,-1.1,-1.0, 0.1,-0.9,-0.8,-0.9,-0.4,-0.9,-0.6,-0.6,-0.3,-0.1,-0.5, 0.1,-0.4,-0.9,-0.3,-0.9,-0.7, 0.2,-0.3, 1.0, 0.3,-0.1,-1.1,-1.7,-0.5,-0.5,-0.2, 1.2, 0.1,-0.8,-1.1,-0.4,-1.4,-0.7,-1.1,-0.6,-0.5,-0.7,-2.8, 0.7,-1.6, 0.6,-0.8, 0.5,-0.6, 0.0,-2.4, 1.2,-1.5, 0.2, 0.1, 1.3,-1.1, 0.8,-2.1, 1.1,-1.2, 0.6,-0.8, 0.3,-0.3, 1.4,-1.6, 0.8,-0.7, 0.5,-0.5, 0.4,-0.4},
{-0.8,-0.2,-2.0, 1.9,-0.1,-0.2, 0.5, 2.4,-3.1, 1.4,-0.6,-0.1,-0.3, 0.1, 1.2, 2.4,-2.8, 2.0,-0.7,-0.9,-0.2, 0.0, 1.7, 2.1,-2.3, 2.3,-0.7, 0.5, 0.1, 0.4, 0.1, 0.6,-2.0, 2.4,-2.2,-1.0, 0.0, 0.0, 1.3, 2.4,-0.6,-1.2,-0.6,-1.4,-0.5,-1.1,-0.5,-0.8,-0.6,-2.9, 0.7,-1.6, 0.7,-0.6, 0.6,-0.5,-0.1,-2.6, 0.9,-1.7, 0.8,-0.5, 0.5,-0.4, 0.6,-2.3, 0.9,-1.3, 0.6,-0.7, 0.4,-0.4, 1.2,-1.8, 0.7,-0.8, 0.4,-0.4, 0.4,-0.5},
{-1.2,-0.2,-1.6, 0.5,-0.9, 1.1,-1.0, 0.6,-2.4, 0.7,-0.9, 1.8, 0.2,-0.4, 0.3,-0.5,-1.7, 1.2,-0.9, 1.4, 0.4,-0.3, 0.2,-0.5,-1.2, 1.5,-0.8, 1.1, 0.5,-0.3, 0.1,-0.5,-0.8, 1.9,-0.3, 0.7, 0.3,-0.3, 0.1,-0.4,-0.7,-1.0,-0.5,-1.5,-0.5,-1.1,-0.5,-0.9,-0.6,-2.8, 1.2,-1.4, 0.8,-0.3, 0.6,-0.1, 0.1,-2.4, 1.0,-1.5, 0.7,-0.5, 0.6,-0.3, 0.7,-2.0, 1.1,-1.3, 0.7,-0.6, 0.5,-0.6, 1.3,-1.5, 0.8,-1.0, 0.5,-0.5, 0.5,-0.6},
{-0.1,-0.9,-0.7,-0.6,-1.0,-0.5,-0.3,-0.1,-0.8,-1.6,-1.3,-0.4,-0.6,-0.7,-0.8,-0.4,-1.3,-1.1,-0.7,-0.7,-0.3,-0.5,-0.2, 0.1,-1.7,-0.8,-0.5,-1.1, 0.0,-0.1,-0.2,-0.1,-2.4,-0.2, 0.0,-1.7,-0.1,-0.2, 0.1, 0.2,-0.7,-1.1,-0.3,-1.5,-0.8,-1.1,-0.3,-0.9,-0.7,-2.9, 1.0,-1.5, 0.6,-0.8, 0.6,-0.5, 0.1,-2.6, 1.1,-1.4, 0.6,-0.1, 0.0,-0.2, 0.7,-2.2, 1.1,-1.3, 0.5,-0.5, 0.3,-0.3, 1.4,-1.7, 0.7,-0.9, 0.4,-0.5, 0.3,-0.4},
{-2.1, 3.1,-0.3, 0.0,-2.8,-1.5, 0.2, 1.0,-4.9, 3.4,-0.1, 0.0,-0.4,-1.4,-0.8,-0.7,-4.2, 3.6,-0.5,-0.7,-0.6,-0.7,-0.9,-0.9,-3.6, 3.7,-1.1,-0.9, 0.3,-0.6,-1.7,-0.6,-2.3, 2.8,-2.8, 1.0,-0.5,-2.0,-0.2, 0.0,-0.7,-1.2,-0.5,-1.6, 0.7,-0.8, 0.8,-0.8,-0.9,-3.1, 0.9,-1.6, 0.6,-0.7, 0.7,-0.5,-0.2,-2.8, 0.8,-1.6, 0.9,-0.6, 0.5,-0.6, 0.6,-2.3, 0.9,-1.4, 0.6,-0.6, 0.5,-0.3, 1.2,-1.9, 0.8,-0.8, 0.3,-0.4, 0.4,-0.5},
{ 0.0,-1.1,-0.7,-1.4,-0.9,-0.8,-0.9,-0.1,-1.0,-2.4,-1.1,-1.3,-0.5,-0.6,-0.5,-0.5,-1.8,-1.8,-1.0,-1.3, 0.1, 0.0, 0.5, 0.4,-2.3,-1.2,-1.0,-1.2, 0.3,-0.1, 0.5, 0.5,-2.8,-0.7,-0.6,-0.9, 0.2,-0.2, 0.3, 0.3,-0.7,-1.1,-0.3,-1.6,-0.5,-0.9,-0.1,-1.1,-0.9,-3.0, 1.4,-1.2, 0.2, 0.0,-0.1, 0.5,-0.1,-2.8, 1.3,-1.1, 0.2, 0.3,-0.5, 0.5, 0.6,-2.3, 1.2,-1.1,-0.1, 0.5,-0.5, 0.4, 1.2,-1.9, 0.8,-0.6,-0.1, 0.1,-0.2, 0.4},
{-0.9, 1.2,-2.8,-1.1,-0.7, 0.1, 1.1, 0.7,-3.2,-0.2,-0.7, 0.2, 0.8, 0.3, 0.2, 0.6,-1.5, 0.3,-1.1, 0.3,-0.1, 0.5,-0.3, 0.1,-1.1, 0.8,-1.5, 0.4, 0.0, 0.0,-0.2, 0.2,-1.0, 1.6,-1.5, 0.5, 0.2,-0.2, 0.0, 0.1,-0.7,-1.2,-0.6,-1.7,-0.5,-0.9,-0.5,-0.8,-1.0,-3.0, 1.3,-1.1, 0.2, 0.1,-0.1, 0.4,-0.3,-2.7, 1.4,-1.2, 0.0, 0.4,-0.3, 0.5, 0.5,-2.2, 1.1,-1.1, 0.0, 0.4,-0.5, 0.4, 1.1,-1.8, 0.8,-0.7,-0.1, 0.1,-0.3, 0.4},
{ 0.3,-0.5,-2.8,-1.5,-0.1, 0.0, 0.9, 4.1,-2.7,-2.0, 0.0, 0.2, 0.7, 0.1, 0.8, 3.9,-1.0, 0.5,-0.6,-1.7, 0.1,-0.2, 0.1, 3.7,-0.9, 0.2,-0.6,-0.4, 0.0,-0.4, 0.3, 2.9,-0.1,-0.5,-1.9, 0.8, 0.8,-1.7, 0.0, 3.6,-0.8,-1.0,-0.4,-1.7,-0.7,-1.2,-0.6,-0.7,-0.6,-3.1, 0.6,-1.5, 0.5,-0.8, 0.6,-0.7, 0.1,-2.7, 1.1,-1.4, 0.6,-0.3, 0.3,-0.1, 0.8,-2.2, 1.1,-1.3, 0.3,-0.2, 0.0, 0.1, 1.3,-1.8, 0.9,-1.0, 0.4,-0.5, 0.3,-0.4},
{-0.9,-0.4,-1.3, 0.4,-0.9, 1.0,-0.6, 0.7,-2.0, 0.7,-1.4, 0.8,-0.7, 0.4,-0.6, 0.3,-1.4, 1.4,-1.3, 1.0, 0.1,-0.2, 0.3,-0.3,-0.9, 2.1,-1.1, 0.8, 0.1,-0.4, 0.2,-0.3,-0.7, 2.4,-0.3, 0.5,-0.1,-0.2, 0.0,-0.3,-0.8,-1.1,-0.4,-1.5,-0.7,-1.2,-0.3,-0.9,-0.6,-3.0, 1.2,-1.3, 0.6,-0.6, 0.7,-0.2, 0.1,-2.6, 1.3,-1.4, 0.7,-0.2, 0.6,-0.2, 0.8,-2.2, 1.1,-1.3, 0.6,-0.4, 0.3,-0.3, 1.4,-1.7, 0.7,-0.9, 0.5,-0.5, 0.4,-0.5},
{ 0.0,-1.0,-0.5,-1.2,-0.8,-0.9,-0.8,-0.2,-0.8,-2.2,-1.0,-1.3,-0.6,-0.6,-0.5,-0.4,-1.5,-1.6,-1.0,-1.4, 0.1, 0.2, 0.5, 0.3,-2.1,-0.9,-0.9,-1.4, 0.4, 0.1, 0.4, 0.4,-2.5,-0.5,-0.6,-1.0, 0.3,-0.1, 0.3, 0.3,-0.8,-1.5,-0.7,-1.2,-0.8,-0.8, 1.6, 0.9,-1.5,-2.9,-0.9,-0.8,-0.4,-0.5,-0.3,-0.3,-0.6,-2.9, 0.4,-1.9, 0.5,-1.0, 0.3,-0.8, 0.3,-2.6, 0.6,-1.6, 0.5,-0.8, 0.4,-0.7, 0.9,-2.1, 0.5,-0.7, 0.1,-0.1, 0.1,-0.2},
{ 0.2,-1.2,-0.6,-1.5,-0.7,-1.2,-0.3,-1.0,-1.0,-2.4,-0.5,-1.4,-0.1,-0.8, 0.0,-0.7,-1.9,-1.9,-0.3,-1.5, 0.4,-0.2, 0.2, 0.8,-2.4,-1.5,-0.2,-1.3, 0.3,-0.2, 0.4, 0.4,-2.9,-1.2, 0.1,-1.0, 0.3, 0.1, 0.2, 0.3,-0.7,-1.2,-0.5,-1.3,-0.7,-1.1,-0.3,-0.7,-0.7,-3.0, 0.9,-1.4, 0.8,-0.6, 0.6,-0.5,-0.1,-2.7, 1.3,-1.2, 1.0,-0.6, 0.5,-0.6, 0.5,-2.2, 1.1,-1.4, 0.7,-0.7, 0.5,-0.7, 1.1,-1.8, 0.7,-1.0, 0.5,-0.5, 0.4,-0.6}
};

//nv
const int n_support[SVM_RESULT_SIZE] = {10,18,19};

//a                               
const float dual_coef[2][SVM_KERNEL_SIZE] = {
{0.0204377306627,0.0229957512846,0.0102222402531,0.0048764548701,0.00591743673347,0.0,0.0,0.0,0.0204376975845,0.0105816006703,-0.0161055138673,-0.00191205968231,-0.0,-0.00171708140755,-0.00387143175638,-0.0113198447268,-0.00501269982444,-0.0,-0.0,-0.00812414913765,-0.0,-0.0146456115747,-0.0,-0.0090338489825,-0.000194566426446,-0.0,-0.0219820544095,-0.00155005026323,-0.0,-0.0068408919556,-0.00287218215079,-0.0,-0.00342776571626,-0.0,-0.0,-0.00702240993071,-0.0,-0.0,-0.0,-0.0,-0.0,-0.0,-0.00286879821503,-0.00154859209033,-0.0,-0.0,-0.0},
{0.0,0.0,0.0,0.0,0.0,0.012854360803,0.00132961282572,0.00198150265119,0.00841516377878,0.0,0.0,0.0,0.00352172964939,0.0,0.0,0.0,0.0,0.000185168697556,0.0104466196507,0.0,0.0200837617344,0.0,0.0404071721615,0.0,0.0,0.0249987713823,0.0,0.0,-0.00894751057836,-0.0,-0.0,-0.00010981233044,-0.0153421005222,-0.0084994020355,-0.0103050754425,-0.00790557348146,-0.00327715546146,-0.00383364054119,-0.0142557937379,-1.75164988101e-06,-0.000413728076842,-0.00404272986728,-0.0,-0.0,-0.0119472874828,-0.00385520478954,-0.00690645727857}
};

//b
const float intercept[SVM_INTERC_SIZE] = {-1.08556928946,0.139166166677,1.10569404593};
//cs
const float classes[SVM_RESULT_SIZE] = {0.0, 1.0, 2.0};

int vlsi_svm_predict(float svm_test_data[SVM_INPUT_SIZE])
{
	//First: kernel => sv dot X_test
	float kvalue[SVM_KERNEL_SIZE];
	int i = 0;
	int j = 0;
	float sum = 0;

	for (i = 0; i < SVM_KERNEL_SIZE; i++) 
    {
		for (j = 0; j < SVM_INPUT_SIZE; j++) 
        {
			sum = sum + support_vector[i][j] * svm_test_data[j];
		}
		kvalue[i] = sum;
		sum = 0;
	}
    
	//Define the start and end index for support vectors for each class
	int n_support_start[SVM_RESULT_SIZE];   // = { 0, 10, 28 };
    for(i = 0; i < SVM_RESULT_SIZE; i++)
    {
        n_support_start[i] = 0;
        for(j = 0; j < i; j++)
        {
            n_support_start[i] += n_support[j];
        }
    }
    
	int n_support_end[SVM_RESULT_SIZE];     // = { 10, 28, 47 };
    for(i = 0; i < SVM_RESULT_SIZE; i++)
    {
        n_support_end[i] = 0;
        for(j = 0; j <= i; j++)
        {
            n_support_end[i] += n_support[j];
        }
    }

	//Calculate: sum(a_p * k(x_p, x)) between every 2 classes
	int p = 0;
	int n = 0;
	int vote[SVM_RESULT_SIZE];
    for(i = 0; i < SVM_RESULT_SIZE; i++)
    {
        vote[i] = 0;
    }
	float decision_value[SVM_INTERC_SIZE];
    
	for (i = 0; i < SVM_RESULT_SIZE; i++) 
    {
		for (j = i + 1; j < SVM_RESULT_SIZE; j++) 
        {
			for (p = n_support_start[j]; p < n_support_end[j]; p++) 
            {
				sum = sum + dual_coef[i][p] * kvalue[p];
			}
			for (p = n_support_start[i]; p < n_support_end[i]; p++) 
            {
				sum = sum + dual_coef[j - 1][p] * kvalue[p];
			}
            
			//Add the intercept
			sum = sum + intercept[n];
			decision_value[n] = sum;
			sum = 0;
            
			//Voting
			if (decision_value[n] > 0)
            {
				vote[i] = vote[i] + 1;
            }
			else
            {
				vote[j] = vote[j] + 1;
            }
			n = n + 1;
		}
	}
    
	volatile int vote_max_index = 0;    //Bug with optimize
    
	for (i = 1; i < SVM_RESULT_SIZE; i++)
    {
		if (vote[i] > vote[vote_max_index])
        {
			vote_max_index = i;
        }
    }
	
    return vote_max_index;
}

